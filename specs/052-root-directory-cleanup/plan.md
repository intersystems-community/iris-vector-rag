# Implementation Plan: Root Directory Cleanup and Reorganization

**Branch**: `052-root-directory-cleanup` | **Date**: 2025-11-24 | **Spec**: [spec.md](./spec.md)
**Input**: Feature specification from `/specs/052-root-directory-cleanup/spec.md`

## Summary

Reduce root directory from 114+ items to fewer than 30 through systematic consolidation of documentation, test files, logs, and configuration files. Move files to appropriate subdirectories (`docs/`, `tests/`, `config/`), update `.gitignore` for comprehensive coverage, and verify no breaking changes to imports or workflows.

**Technical Approach**: Pure organizational work - no code implementation required. Execution via bash scripts and manual file operations, validated through `git status`, `ls` counts, and import verification.

## Technical Context

**Language/Version**: N/A (organizational cleanup - no code changes)
**Primary Dependencies**: N/A (filesystem operations only)
**Storage**: Filesystem (no database involvement)
**Testing**: Manual validation via `git status`, `ls -la | wc -l`, `grep -r "import"` for break detection
**Target Platform**: Development workstations (macOS/Linux)
**Project Type**: Single Python package (`iris_vector_rag/`)
**Performance Goals**: <15 minutes developer time (per NFR-001)
**Constraints**: Zero breaking changes to imports (NFR-007), CI/CD unchanged (NFR-008), Docker builds unaffected (NFR-009)
**Scale/Scope**: 114 items → <30 items (75% reduction per SC-001)

## Constitution Check

*GATE: Must pass before Phase 0 research. Re-check after Phase 1 design.*

### Principle I: Library-First Design
**Status**: ✅ **NOT APPLICABLE** - No library code being written. This is filesystem reorganization only.

### Principle II: .DAT Fixture-First Testing
**Status**: ✅ **NOT APPLICABLE** - No integration tests required. Organizational changes validated through filesystem commands (`ls`, `git status`).

### Principle III: Test-First (TDD)
**Status**: ✅ **NOT APPLICABLE** - No code implementation. Validation is declarative: count root items, verify clean `git status`, check imports don't break.

### Principle IV: Backward Compatibility
**Status**: ⚠️ **REQUIRES ATTENTION** - Must verify:
- FR-010: Grep codebase for `import iris_rag`, `import rag_templates`, `import common` before removal
- FR-007: Test suite paths remain valid after moving test files to `tests/`
- NFR-007: Explicitly states "MUST NOT break existing imports or module references"

**Verification Strategy**:
```bash
# Before any deletions
grep -r "from iris_rag" --include="*.py" .
grep -r "from rag_templates" --include="*.py" .
grep -r "from common" --include="*.py" .
pytest tests/  # Verify tests still pass after moves
```

### Principle V: InterSystems IRIS Integration
**Status**: ✅ **NOT APPLICABLE** - No IRIS database operations. Configuration files like `iris.key` are being moved, not modified.

### Principle VI: Performance Standards
**Status**: ✅ **SATISFIED** - NFR-001 requires cleanup operations complete within 15 minutes of developer time. Bash scripts for file moves execute in seconds.

### Principle VII: Observability
**Status**: ✅ **NOT APPLICABLE** - No production code changes. Documentation in CHANGELOG (NFR-006) provides transparency.

### Principle VIII: Security-First
**Status**: ⚠️ **REQUIRES ATTENTION** - FR-022 moves `.key` files to `.gitignore`d `config/` directory. Must verify:
- `config/` added to `.gitignore` before moving secrets
- No secrets accidentally committed during transition

### Principle IX: Simplicity (YAGNI)
**Status**: ✅ **SATISFIED** - Cleanup removes complexity by eliminating duplicate directories, redundant config files, and scattered documentation.

**Overall Gate Status**: ✅ **PASS** (with attention items for Principles IV and VIII captured in tasks)

## Project Structure

### Documentation (this feature)

```text
specs/051-root-directory-cleanup/
├── spec.md              # Feature specification (completed)
├── plan.md              # This file
├── research.md          # Phase 0: Best practices for Python project organization
└── tasks.md             # Phase 2: Task breakdown (generated by /speckit.tasks)
```

**Note**: No `data-model.md`, `contracts/`, or `quickstart.md` needed - this is organizational work, not feature development.

### Source Code (repository root - BEFORE cleanup)

```text
# Current state: 114+ items including:
/
├── iris_vector_rag/         # PRIMARY package (keep)
├── iris_rag/                # Legacy package (check imports, remove or deprecate)
├── rag_templates/           # Legacy package (check imports, remove or deprecate)
├── common/                  # Legacy package (check imports, remove or deprecate)
├── tests/                   # Test directory (consolidate scattered tests here)
├── docs/                    # Documentation directory (consolidate markdown here)
├── test_*.py                # Scattered test files (move to tests/)
├── *.log (10+ files)        # Log files (process per FR-003)
├── outputs/                 # Output directory (add to .gitignore)
├── reports/                 # Output directory (add to .gitignore)
├── dist/                    # Build artifacts (add to .gitignore)
├── build/                   # Build artifacts (add to .gitignore)
├── poetry.lock              # Legacy dependency file (remove per FR-014)
├── requirements.txt         # Generated dependency file (remove per FR-015)
├── requirements-dev.txt     # Generated dependency file (remove per FR-015)
├── iris.key                 # Config file (move to config/)
├── temp_iris.key            # Config file (move to config/ or remove duplicate)
├── mem0_integration/        # Orphaned integration (remove or relocate)
├── nodejs/                  # Language-specific dir (remove or relocate)
├── objectscript/            # Language-specific dir (remove or relocate)
└── [90+ other items]
```

### Source Code (repository root - AFTER cleanup)

```text
# Target state: <30 items
/
├── iris_vector_rag/         # PRIMARY package (unchanged)
├── tests/                   # All tests consolidated here
├── docs/                    # All documentation consolidated here
│   ├── archive/             # Git-tracked archived files (FR-008)
│   └── logs/historical/     # Historical logs <3 months (FR-003)
├── config/                  # Configuration files (.gitignored)
│   ├── README.md            # Explains purpose of .key files
│   ├── iris.key             # Moved from root
│   └── [other .key files]
├── .gitignore               # Updated for comprehensive coverage
├── .env.example             # Template (tracked)
├── pyproject.toml           # Primary dependency file (keep)
├── uv.lock                  # Primary lock file (keep)
├── README.md                # Project README (keep at root)
├── CHANGELOG.md             # Changelog (keep at root)
├── LICENSE                  # License (keep at root)
├── Makefile                 # Build automation (keep)
├── docker-compose.yml       # Docker config (keep)
├── .specify/                # Specification framework (keep)
├── .claude/                 # Claude Code config (keep)
├── .github/                 # GitHub workflows (keep)
└── [<15 other essential files]
```

**Structure Decision**: Single Python package (`iris_vector_rag/`) with standard Python project layout. All cleanup occurs at repository root level - no changes to package internals.

## Complexity Tracking

**No violations to justify** - This cleanup *reduces* complexity by:
- Eliminating duplicate package directories
- Consolidating scattered documentation
- Removing redundant configuration files
- Cleaning up historical artifacts

Constitution Principle IX (Simplicity) is strengthened, not violated.

## Phase 0: Research

**Status**: Required - Need Python project organization best practices

**Research Questions**:
1. What is the standard Python project structure per PEP guidelines?
2. What items typically remain at project root vs. moved to subdirectories?
3. What are best practices for `.gitignore` organization and commenting?
4. How to safely verify import statements before removing legacy package directories?
5. What is the recommended approach for consolidating multiple `.env` files?

**Output**: `research.md` with decisions on:
- Python project root structure best practices
- `.gitignore` patterns for comprehensive coverage
- Safe import verification strategy
- Configuration file consolidation approach

## Phase 1: Design (SIMPLIFIED - No code contracts needed)

**Status**: Not applicable - organizational work requires documentation only

**Deliverables** (adjusted for organizational feature):
- ✅ **research.md**: Best practices research (Phase 0 output)
- ❌ **data-model.md**: Not applicable (no entities or data models)
- ❌ **contracts/**: Not applicable (no API contracts)
- ❌ **quickstart.md**: Not applicable (no user-facing features)
- ✅ **Updated plan.md**: This file (documenting approach)

**Rationale**: Pure organizational cleanup doesn't require traditional software design artifacts. Validation is through filesystem state verification, not unit tests.

## Phase 2: Task Breakdown

**Output**: Generated by `/speckit.tasks` command (not part of `/speckit.plan`)

**Expected task categories**:
1. **Pre-flight checks**: Verify imports, backup strategy, git status clean
2. **Directory consolidation**: Move test files, documentation, logs per requirements
3. **Configuration consolidation**: Handle `.env` and `.key` files per FR-021, FR-022
4. **Legacy package handling**: Grep for imports, remove or deprecate per FR-010
5. **`.gitignore` updates**: Add comprehensive patterns per FR-017, FR-018, FR-019
6. **Validation**: Count root items, verify git status clean, run test suite
7. **Documentation**: Update README, create CHANGELOG entry per NFR-006

## Notes

### Feature Number Conflict
⚠️ This feature is numbered `051` but conflicts with existing Feature 051 (Simplify IRIS Connection Architecture from v0.5.11-v0.5.13). The setup script detected this conflict:
```
ERROR: Multiple spec directories found with prefix '051': 051-root-directory-cleanup 051-simplify-iris-connection
```

**Recommendation**: Renumber this feature to `052` or next available number before proceeding to `/speckit.tasks` phase.

### Organizational Feature Characteristics
This is an **organizational cleanup feature**, not a software development feature. Therefore:
- No library code implementation
- No API contracts or data models
- No unit/integration tests (validation via filesystem commands)
- Success measured through filesystem state (SC-001: <30 items, SC-003: clean git status)

Constitution principles that apply:
- ✅ Principle IV (Backward Compatibility) - Verify imports don't break
- ✅ Principle VI (Performance) - <15 minutes developer time
- ✅ Principle VIII (Security) - Protect `.key` files during move
- ✅ Principle IX (Simplicity) - This cleanup reduces complexity
