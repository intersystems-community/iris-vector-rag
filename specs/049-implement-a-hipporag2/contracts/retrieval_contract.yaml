# HippoRAG2 Retrieval Service Contract
# API: HippoRAG2Retriever.retrieve()
# Spec Reference: FR-012, FR-016, FR-017 (multi-stage retrieval)

contract_version: "1.0.0"
service_name: "HippoRAG2Retriever"

---

## Method: retrieve()

### Signature
```python
def retrieve(
    self,
    query: str,
    top_k: int = 20,
    graph_expansion_hops: int = 2
) -> List[Passage]
```

### Parameters
| Name | Type | Required | Default | Description | Validation |
|------|------|----------|---------|-------------|------------|
| `query` | str | Yes | N/A | Natural language query | Non-empty |
| `top_k` | int | No | 20 | Number of passages to return | 1 ≤ top_k ≤ 100 |
| `graph_expansion_hops` | int | No | 2 | Graph traversal depth | 1 ≤ hops ≤ 3 |

### Return Value
```python
[
    Passage(passage_id=UUID, content="...", relevance_score=0.95, entities_mentioned=[...]),
    Passage(passage_id=UUID, content="...", relevance_score=0.87, entities_mentioned=[...]),
    ...
]
```
Sorted by `relevance_score` descending

### Three-Stage Algorithm
1. **Entity Linking**: Extract entities from query, link to KG
2. **Graph Expansion**: Traverse KG for related entities (1-2 hops)
3. **Passage Ranking**: Vector search + entity-based filtering

### Performance Target (spec NFR-005)
- Total retrieval time < 800ms at 1M document scale
  - Stage 1: ~50ms
  - Stage 2: ~150ms
  - Stage 3: ~300ms
