# RAG Templates Database Schema Configuration
# Centralized definition of all table and column names for consistency

schema:
  name: "RAG"
  description: "Main schema for RAG Templates data"

tables:
  # Main document storage
  source_documents:
    name: "SourceDocuments"
    description: "Primary document storage with embeddings"
    columns:
      id: id
      doc_id: doc_id
      title: title
      abstract: abstract
      text_content: text_content
      authors: authors
      keywords: keywords
      embedding: embedding
      metadata: metadata
      created_at: created_at
    indexes:
      - name: idx_source_docs_id
        columns:
        - doc_id
        type: primary
      - name: idx_hnsw_source_embedding
        columns:
        - embedding
        type: vector
      - name: idx_source_docs_created
        columns:
        - created_at

  # Document chunks for CRAG
  document_chunks:
    name: "DocumentChunks"    # Current actual table name
    alias: "ChunkedDocuments" # Alternative name
    description: "Document chunks for CRAG pipelines"
    columns:
      id: id
      chunk_id: chunk_id
      doc_id: doc_id
      chunk_text: chunk_text
      chunk_embedding: chunk_embedding
      chunk_index: chunk_index
      chunk_type: chunk_type
      metadata: metadata
      created_at: created_at
    indexes:
      - name: idx_chunks_doc_id
        columns:
        - doc_id
      - name: idx_chunks_type
        columns:
        - chunk_type
      - name: idx_hnsw_chunk_embedding
        columns:
        - chunk_embedding
        type: vector

# Column name mappings for standardization
column_mappings:
  # Standardize document ID column names
  document_id_variants:
    - "doc_id"
    - "document_id"
    - "pmc_id"
  standard: "doc_id"

  # Standardize content column names
  content_variants:
    - "text_content"
    - "content"
    - "chunk_text"
    - "full_text"
  standard: "text_content"

  # Standardize embedding column names
  embedding_variants:
    - "embedding"
    - "chunk_embedding"
    - "token_embedding"
  standard: "embedding"

# Data types and constraints
data_types:
  doc_id: "VARCHAR(255)"
  text_content: "LONGVARCHAR"
  embedding: "VARCHAR(32000)"  # IRIS vector format
  vector_dimension: 384  # all-MiniLM-L6-v2 model
  timestamp: "TIMESTAMP"
  metadata: "VARCHAR(4000)"

# Testing configuration
testing:
  sample_sizes:
    small: 10
    medium: 100
    large: 1000
  test_tables:
    prefix: "TEST_"
    cleanup_after: true