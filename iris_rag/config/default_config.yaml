# Default configuration for iris_rag package
database:
  iris:
    driver: "intersystems_iris.dbapi._DBAPI"
    host: "localhost"
    port: "1972"
    namespace: "USER"
    username: "_SYSTEM"
    password: "SYS"

storage:
  iris:
    table_name: "RAG.SourceDocuments"
    vector_dimension: 384

# Vector index configuration for optimal HNSW performance
vector_index:
  type: "HNSW"                    # Index type: HNSW for high-performance vector search
  M: 16                          # Number of bi-directional links for each node (higher = better recall, more memory)
  efConstruction: 200            # Size of dynamic candidate list (higher = better quality, slower build)
  Distance: "COSINE"             # Distance metric: COSINE, EUCLIDEAN, or DOT

pipelines:
  basic:
    chunk_size: 1000
    chunk_overlap: 200
    default_top_k: 5
    embedding_batch_size: 32
  vector_query_mode: "safe_single_param"
  vector_hnsw:
    ensure_on_start: true
    try_acorn: true

embeddings:
  default_provider: "sentence_transformers"
  sentence_transformers:
    model_name: "all-MiniLM-L6-v2"
    device: "cpu"

# Entity extraction configuration
entity_extraction:
  enabled: true
  method: "ontology_hybrid"              # ontology_hybrid, llm_basic, pattern_only, hybrid
  confidence_threshold: 0.7              # Minimum confidence score for entities
  entity_types:                         # Enabled entity types (auto-detected from ontology if available)
    - "ENTITY"
    - "CONCEPT" 
    - "PROCESS"
    - "RESOURCE"
    - "EVENT"
  llm:
    model: "gpt-4"                       # LLM model for extraction
    temperature: 0.1                     # Low temperature for consistent extraction
    max_tokens: 2000                     # Max tokens for LLM response
  storage:
    entities_table: "RAG.Entities"      # Database table for entities
    relationships_table: "RAG.EntityRelationships"  # Table for relationships
    embeddings_table: "RAG.EntityEmbeddings"        # Table for entity embeddings

# General-purpose ontology configuration for ANY domain
ontology:
  enabled: false                         # Enable/disable ontology support
  type: "general"                        # Single general-purpose type (replaces domain-specific plugins)
  auto_detect_domain: true               # Auto-detect domain from ontology metadata
  
  # Ontology data sources - works with ANY valid ontology
  sources:
    - type: "owl"                        # Ontology format: owl, rdf, skos, xml, ttl, n3
      path: "path/to/any/ontology.owl"   # Path to ontology file (ANY domain)
      # Optional: override auto-detection
      # domain: "custom_domain_name"
    
    # Examples for different domains:
    # - type: "owl"
    #   path: "ontologies/medical/umls.owl"        # Medical domain
    # - type: "skos" 
    #   path: "ontologies/legal/legal_terms.skos"  # Legal domain
    # - type: "rdf"
    #   path: "ontologies/financial/fibo.rdf"      # Financial domain
    # - type: "owl"
    #   path: "ontologies/scientific/research.owl" # Scientific domain
  
  # Custom domain definitions (optional)
  custom_domains:
    enabled: false                       # Enable custom domain definitions
    definition_path: null                # Path to JSON file with domain configuration
    # Example JSON structure:
    # {
    #   "domain_name": "biomedical",
    #   "description": "Biomedical research domain",
    #   "entity_types": {
    #     "PROTEIN": ["protein", "enzyme", "antibody"],
    #     "GENE": ["gene", "allele", "locus"]
    #   },
    #   "extraction_patterns": {
    #     "PROTEIN": ["\\b[A-Z][a-z]+\\d+\\b"]
    #   },
    #   "synonyms": {
    #     "protein": ["enzyme", "polypeptide"]
    #   }
    # }
  
  # Reasoning engine configuration
  reasoning:
    enable_inference: true               # Enable ontology-based reasoning
    max_inference_depth: 3               # Maximum depth for concept traversal
    confidence_threshold: 0.6            # Minimum confidence for inferred relationships
    reasoning_strategies:                # Active reasoning strategies
      - "subsumption"                    # Hierarchical concept reasoning
      - "property_based"                 # Property-based inference
      - "rule_based"                     # Custom rule application
  
  # Entity mapping configuration
  entity_mapping:
    auto_map: true                       # Automatically map concepts to entity types
    auto_domain_detection: true          # Auto-detect relevant domains from text
    expansion_strategy: "synonyms"       # Query expansion: synonyms, hierarchical, semantic
    # Note: custom_mappings are now auto-generated from loaded ontologies
    
  # Performance and optimization settings
  performance:
    max_concepts_per_domain: 10000       # Limit concepts loaded per domain
    cache_ontology_queries: true         # Cache frequently used ontology queries
    lazy_load_concepts: true             # Load concepts on-demand
    concept_similarity_threshold: 0.8    # Minimum similarity for concept matching

# GraphRAG pipeline configuration with general ontology support
graphrag:
  enabled: true                          # Enable GraphRAG pipeline
  default_top_k: 10                      # Default number of results to return
  max_depth: 2                           # Maximum graph traversal depth
  max_entities: 50                       # Maximum entities per traversal
  enable_vector_fallback: false          # Fallback to vector search if graph fails
  
  # General ontology integration for GraphRAG
  ontology_integration:
    query_expansion: true                # Expand queries using ontology concepts
    entity_enrichment: true              # Enrich extracted entities with ontology data
    relationship_inference: true         # Infer relationships using ontology reasoning
    semantic_similarity: true            # Use semantic similarity for entity matching
    
  # Visualization settings
  visualization:
    enabled: true                        # Enable graph visualization
    default_type: "plotly"               # Default visualization: plotly, d3, traversal
    highlight_ontology_concepts: true    # Highlight ontology-derived concepts
    show_inference_paths: true           # Show reasoning inference paths

# Example configurations for different domains:

# Medical/Healthcare Domain Example:
# ontology:
#   enabled: true
#   sources:
#     - type: "owl"
#       path: "ontologies/umls/umls_core.owl"
#     - type: "skos"
#       path: "ontologies/snomed/snomed_ct.skos"

# Legal Domain Example:
# ontology:
#   enabled: true
#   sources:
#     - type: "owl"
#       path: "ontologies/legal/lkif.owl"
#     - type: "rdf"
#       path: "ontologies/legal/legislation.rdf"

# Financial Domain Example:
# ontology:
#   enabled: true
#   sources:
#     - type: "owl"
#       path: "ontologies/fibo/fibo_core.owl"
#     - type: "skos"
#       path: "ontologies/finance/financial_terms.skos"

# Scientific Research Domain Example:
# ontology:
#   enabled: true
#   sources:
#     - type: "owl"
#       path: "ontologies/science/research_methods.owl"
#     - type: "rdf"
#       path: "ontologies/science/publications.rdf"

# Multi-Domain Example:
# ontology:
#   enabled: true
#   sources:
#     - type: "owl"
#       path: "ontologies/medical.owl"
#     - type: "owl"
#       path: "ontologies/legal.owl"
#     - type: "skos"
#       path: "ontologies/general_terms.skos"